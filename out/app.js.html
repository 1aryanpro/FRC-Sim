<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: app.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: app.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Class representing a Deposit
 */
class Deposit {
	/**
	 * Creates a Deposit
	 * @param {GameField} field The Game Field that the Deposit is on
	 * @param {Integer} distance The distance between the pickup location and this deposit
	 * @param {Integer} points The points awarded per batch of items depositied
	 * @param {Integer} seconds The seconds awarded per item deposited
	 * @param {Integer} [batchSize=1] The number of item in a batch
	 */
	constructor(field, distance, points, seconds, batchSize = 1) {
		this.field = field;
		this.distance = distance;

		this.points = points;
		this.seconds = seconds;
		this.batchSize = batchSize;

		this.counter = 0;
	}

	/**
	 * Deposits items and calculates points and seconds
	 * @param {Integer} [count=1] The number of items being deposited
	 * @returns {Array} An array containing the points and seconds awarded, in that order.
	 */
	depositItems(count = 1) {
		this.counter += count;
		var out = [0, this.field.addTime(this.seconds * count)];

		while (this.counter >= this.batchSize) {
			out[0] += this.points;
			this.counter -= this.batchSize;
		}

		return out;
	}
}

/**
 * Class template representing a Robot. Cannot be used on it's own.
 */
class Robot {
	/**
	 * Initializes the properties of the Class
	 * @param {Number} speed The speed of the Robot in ft/s
	 * @param {Boolean} [escapeBuilding=true] Wheather the Robot escapes the building at the end of the game
	 */
	constructor(speed, escapeBuilding = true) {
		this.points = 0;
		this.seconds = 0;
		this.oppSeconds = 0;

		this.speed = speed;
		this.objectsHeld = 0;

		this.escapeBuilding = escapeBuilding;

		this.timer = 0;
	}

	/**
	 * Empty Function DO NOT use
	 */
	decideNextTask() {}

	/**
	 * Calculates the actions happening in 0.1 seconds of real time
	 * @param {Integer} timeRemaining The time remaining in the game in tenths of seconds
	 */
	step(timeRemaining) {
		if (timeRemaining &lt; 40 / this.speed + 80) return;

		this.timer--;
		if (this.timer &lt;= 0) {
			this.decideNextTask(timeRemaining);
		}
	}
}

/**
 * Represents a robot that deposits water the whole game
 * @extends Robot
 */
class OwnWaterRobot extends Robot {
	/**
	 *
	 * @param {Number} speed The speed of the Robot in ft/s
	 * @param {Deposit} port The Deposit that the robot is going to
	 * @param {Number} shootSpeed The time it takes for a robot to shoot a batch of balls
	 * @param {Float} accuracy The probability that a shot lands
	 * @param {Number} pickupSpeed The time it takes for the robot to pick up 5 balls
	 * @param {Number} manueverPenalty The time it takes to manuever the robot around obstacles on average. This values is added when calculating travel time
	 * @param {Boolean} [dump=false] Whether the Robot dumps all items at once or shoots them one at a time.
	 */
	constructor(
		speed,
		port,
		shootSpeed,
		accuracy,
		pickupSpeed,
		manueverPenalty,
		dump = false
	) {
		super(speed);
		this.port = port;
		this.shootSpeed = shootSpeed * 10;
		this.accuracy = accuracy;
		this.pickupSpeed = pickupSpeed * 10;
		this.dump = dump;

		this.travelTime = port.distance / (speed / 10) + manueverPenalty * 10;
		this.travelTime = Math.round(this.travelTime);

		this.state = 2;
	}

	shoot() {
		this.dump ? (this.objectsHeld = 0) : this.objectsHeld--;
		this.timer += this.shootSpeed;
	}

	/**
	 * Decided what the Robot's next task is and updates timers and other information accordingly.
	 * @param {Integer} timeRemaining The time remaining in the game in tenths of seconds
	 */
	decideNextTask(timeRemaining) {
		// 0: Traveling to Water Port
		// 1: Shooting
		// 2: Traveling Home
		// 3: Pick Up Water

		switch (this.state) {
			case 0:
				this.state++;
				this.shoot();
				break;
			case 1:
				if (Math.random() &lt; this.accuracy) {
					var shot = this.dump
						? this.port.depositItems(5)
						: this.port.depositItems(1);
					this.seconds += shot[1];
					this.points += shot[0];
				}

				if (this.objectsHeld == 0) {
					this.state++;
					this.timer += this.travelTime;
				} else this.shoot();
				break;
			case 2:
				this.state++;
				this.timer += this.pickupSpeed;
				break;
			case 3:
				this.state = 0;
				this.objectsHeld = 5;
				this.timer += this.travelTime;
				break;
		}
	}
}

/**
 * Class that represents one alliances side of the game field
 */
class GameField {
	/**
	 * Creates a Game Field
	 */
	constructor() {
		// Center Water Port, Own Water Port, Vault
		const distances = [24.3, 25.6, 60];

		var ownBotWaterPort = new Deposit(this, distances[1], 1, 1, 3);
		var ownTopWaterPort = new Deposit(this, distances[1], 1, 3);
		var centerWaterPort = new Deposit(this, distances[0], 7, 1, 2);
		var artifactDeposit = new Deposit(this, undefined, 20, 0);

		this.ports = [
			ownBotWaterPort,
			ownTopWaterPort,
			centerWaterPort,
			artifactDeposit,
		];

		this.timer = 0;
		this.timeLimit = 900;

		var waterRobot = new OwnWaterRobot(6, ownTopWaterPort, 1, 0.9, 2, 5);
		this.robots = [waterRobot];
	}

	/**
	 * Adds seconds to the game clock while keeping the 180 second maximum rule
	 * @param {Integer} seconds The number of seconds being added to the game time
	 * @returns {Number} The amount of seconds actually added to the clock, defers from paramter when maximum game length is reached
	 */
	addTime(seconds) {
		var oldTimeLimit = this.timeLimit;
		this.timeLimit += seconds * 10;
		if (this.timeLimit > 1800) this.timeLimit = 1800;
		return (this.timeLimit - oldTimeLimit) / 10;
	}

	/**
	 * Simulates the game by running the step function of each of the robots with the appropriate parameters and calls the output function
	 */
	simulateGame() {
		while (this.timer &lt; this.timeLimit) {
			var timeRemaining = this.timeLimit - this.timer;
			this.robots.forEach((robot) => {
				robot.step(timeRemaining);
			});
			this.timer++;
		}
		this.output();
	}

	/**
	 * Outputs the specified values in format to the console
	 */
	output() {
		console.log(`game length: ${this.timeLimit / 10} seconds`);
		console.log(this.robots);
	}
}

var game = new GameField();
game.simulateGame();
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Deposit.html">Deposit</a></li><li><a href="GameField.html">GameField</a></li><li><a href="OwnWaterRobot.html">OwnWaterRobot</a></li><li><a href="Robot.html">Robot</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Aug 27 2021 20:53:16 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
